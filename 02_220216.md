# 데이터 전처리_연령별 질병확인



 ### 데이터 불러오기

```python
import pandas as pd
import numpy as np
from pandas import Series, DataFrame

df1 = pd.read_csv('./data/T20_2019_1백만.1.csv', encoding='cp949')
df2 = pd.read_csv('./data/T20_2019_1백만.2.csv', encoding='cp949')
df3 = pd.read_csv('./data/T20_2019_1백만.3.csv', encoding='cp949')
df4 = pd.read_csv('./data/HP_T20_2020_1.CSV', encoding='cp949')
df5 = pd.read_csv('./data/HP_T20_2020_2.CSV', encoding='cp949')
df6 = pd.read_csv('./data/HP_T20_2020_3.CSV', encoding='cp949')
```

​	데이터를 불러온다. for문 구문을 사용했지만 파일이 제대로 읽히지 않아 각각 불렀다.



---



### 데이터 병합하기_concat()

```python
data = pd.concat([df1,df2,df3,df4,df5,df6], ignore_index=True)
data.info()
```

​	불러온 데이터를 concat() 함수를 통해 병합하는데, 이때 인덱스는 무시한다.



---



### 주상병코드로 질병 빈도수 확인하기

```python
data.value_counts('주상병코드')
```

​	전체적으로 봤을 땐, 감기(J209)가 가장 많았고, 고혈압(I109), 알츠하이머성 치매(F_), 당뇨병(E119) 가 잇따라 순위에 들었다.



---



### 연령대코드 빈도수 확인하기

```python
data.value_counts('연령대코드')
```

​	13코드가 가장 많이 진료를 받았고, 다음으로 12, 14, 15 순이다. 그리고 가장 적게 진료를 받은 구간은 4번으로 13과 약 4배 이상 차이가 난다.

- 1등 60~64세(13)
- 2등 55~59세(12)
- 3등 65~69세(14)
- 4등 70~74세(15)
- 5등 50~54세(11)
- 꼴등15 ~ 19세(04)



---



### 연령대코드 조건 추출

```python
condition = data['연령대코드'] == 1
age_1 = data[condition]
age_1.head()

from collections import Counter
age_1_total = Counter(age_1['주상병코드'])
age_1_count = age_1_total.most_common(30)
```

​	연령대별 질병을 알아내기 위해 연령대코드로 먼저 데이터를 나누고, 주상병코드를 기준으로 most_common() 함수를 사용해 상위 30개의 질병을 확인했다.



---



### 엑셀 저장

```python
type(age_1_count)
age_1_df = pd.DataFrame(age_1_count, columns=['주상병코드', '빈도수'])
age_1_df.to_excel('./data/age_1.xlsx', index=False)
```

​	파일을 저장할 건데, 데이터 타입이 list 타입이라서 dataframe으로 바꿔주는 작업이 필요하다. 그리고 to_excel() 함수를 통해 저장한다. 이 방법으로 모든 코드를 나눈다.



---



### insight

0~4(01) : 상세불명의 급성 기관지염(감기, J209)가 압도적. 대부분 기관지 관련 질병. 중간에 화농성 중이염(H66000)이랑 헤르페스(단순포진) 증상 보임
호흡기 질환 

5~9(02) : 여기도 1번과 비슷. J209가 가장 많고, 대부분이 기관지 질병. 아토피(H101) 증상 보임. 감염성대장염(A090) 보임. 그리고 F_ 등장.

10~14(03) : 여전히 J209가 1위지만 많이 줄은 것으로 보임. 근시(H521) 질병 5번째 기록. 알쯔하이머 치매(F_) 6번째 기록(증가). 기관지 질병이 상위권. 
중간에 대장염(A099), 선천성 요오드 결필 증후근(E_) 등장

15~19(04) : 대체적으로 질병이 많지 않음. 1위 J209. F_가 2번째 기록(증가). 급성 신염 증후군(N_) 등장. 위염(K297) 등장. 허리통증(M5456) 등장.

20~24(05) : F_ 1위.(증가), 급성 신염 증후군(N_) 증가, 알레르기성 접촉피부염(L239) 증가

25~29(06) : N_ 1위 기록(증가), F_여전히 2위, 증상 호소 또는 보고된 진단명 없는 사람의 일반적 검사 및 조사(Z_). 다양해짐

30~34(07) : 감기 1등, N(신염) 2위, F_3위, Z_ 4위(건강검진 같음, 2년마다 국가 지원 포함), O_ 급증(자궁외임신), 아무래도 결혼정련기 영향(산부인과), A_콜레라 순위 급감

35~39(08) : O_ 뒤로 밀려남, 편도염(J0390) 순위 증가, 

40~44(09) : 감기 다시 1위, I109(고혈압) 4위 등장, K210(위식도 질환), 식습관 관련 질환이 증가하는 것 같음, D_(구강, 식도 관련 암종) 순위권

45~49(10) : 고혈압 1위, 감기 2위, E119(당뇨병) 5위 순위 증가

50~54(11) : 고혈압 1위.

55~59(12) : 고혈압, 협심증, 당뇨, 무릎관절, 만성질환 심장병

60~64(13) : 고혈압, 당뇨, 감기, 치매, 상위권, M자체가 많아짐(관절염)

65~69(14) : 앞과 비슷하게 나타남.

겹치는 부분이 있다. 병명이 다양하다.

70~74(15) : 고혈압 1위.

75~79(16) : 고혈압 압도적 1위.



---



### 평가

​	첫 번째 전처리 대강 완료된 것 같음. 이제 두 번째 병원 위치 기반 전처리만 잘 마치면 될 듯 싶다. 오늘도 목표한 것을 다 완료하고 마쳤다.
